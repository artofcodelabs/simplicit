{"version":3,"file":"loco-core.js","mappings":"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","sources":["webpack://LocoCore/webpack/universalModuleDefinition","webpack://LocoCore/webpack/bootstrap","webpack://LocoCore/webpack/runtime/define property getters","webpack://LocoCore/webpack/runtime/hasOwnProperty shorthand","webpack://LocoCore/webpack/runtime/make namespace object","webpack://LocoCore/./src/init.js","webpack://LocoCore/./src/helpers.js","webpack://LocoCore/./src/start/config.js","webpack://LocoCore/./src/start/id.js","webpack://LocoCore/./src/start/init.js","webpack://LocoCore/./src/start.js","webpack://LocoCore/./src/start/scan.js","webpack://LocoCore/./src/start/validate.js","webpack://LocoCore/./src/start/observe.js","webpack://LocoCore/./src/component.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"LocoCore\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"LocoCore\"] = factory();\n\telse\n\t\troot[\"LocoCore\"] = factory();\n})(window, function() {\nreturn ","// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","let namespaceController = null;\nlet controller = null;\n\nconst callFunc = (resource, name) => {\n  if (typeof resource.constructor[name] === \"function\") {\n    resource.constructor[name]();\n  }\n  if (typeof resource[name] === \"function\") {\n    resource[name]();\n  }\n};\n\nconst getController = (Controllers, name, subName) => {\n  const resource =\n    subName === undefined ? Controllers[name] : Controllers[name][subName];\n  if (typeof resource === \"function\") {\n    return new resource();\n  } else if (typeof resource === \"object\") {\n    return resource;\n  }\n  return null;\n};\n\nconst init = (Controllers) => {\n  const body = document.getElementsByTagName(\"body\")[0];\n  const namespaceName = body.getAttribute(\"data-namespace\");\n  const controllerName = body.getAttribute(\"data-controller\");\n  const actionName = body.getAttribute(\"data-action\");\n\n  if (controller !== null) {\n    callFunc(controller, \"deinitialize\");\n    controller = null;\n  }\n  if (namespaceController !== null) {\n    callFunc(namespaceController, \"deinitialize\");\n    namespaceController = null;\n  }\n\n  namespaceController = getController(Controllers, namespaceName);\n  controller = getController(Controllers, controllerName);\n\n  if (namespaceController !== null) {\n    controller = getController(Controllers, namespaceName, controllerName);\n    namespaceController.controller = controller;\n    callFunc(namespaceController, \"initialize\");\n  }\n  if (controller !== null) {\n    controller.namespaceController = namespaceController;\n    callFunc(controller, \"initialize\");\n    callFunc(controller, actionName);\n  }\n\n  return { namespaceController, controller, action: actionName };\n};\n\nexport default init;\n","const fetchParams = (url = window.location.href) => {\n  const params = {};\n  const match = /https?:\\/\\/.+\\/\\w+\\/(\\d+)/.exec(url);\n  const id = match !== null ? match[1] : null;\n  if (id !== null) {\n    params[\"id\"] = parseInt(id);\n  }\n  const splitUrl = url.split(\"?\");\n  if (splitUrl.length === 1) return params;\n  const paramsString = splitUrl[splitUrl.length - 1];\n  const paramsArray = paramsString.split(\"&\").map((s) => s.split(\"=\"));\n  for (const arr of paramsArray) {\n    let key = decodeURIComponent(arr[0]);\n    let val = decodeURIComponent(arr[1]);\n    if (typeof val === \"string\") {\n      val = val.replace(/\\+/g, \" \");\n    }\n    params[key] = val;\n  }\n  return params;\n};\n\nexport default {\n  get params() {\n    return fetchParams();\n  },\n};\n","export const dataComponentAttribute = \"data-component\";\n","let componentIdCounter = 1;\nexport const generateComponentId = () => `${componentIdCounter++}`;\n","import { generateComponentId } from \"./id\";\n\nexport const initComponent = (node, ComponentClass) => {\n  const instance = new ComponentClass();\n  instance.element = node.element;\n  const { parent, children } = { ...node };\n  instance.node = { parent, children };\n  instance.componentId = generateComponentId();\n  return instance;\n};\n\nexport const extendElement = (element, instance) => {\n  element.setAttribute(\"data-component-id\", instance.componentId);\n  element.instance = instance;\n};\n\nexport const initMatches = (nodes, componentClasses) => {\n  const instances = [];\n  for (const ComponentClass of componentClasses) {\n    for (const node of nodes) {\n      if (node.name != ComponentClass.name) continue;\n\n      const instance = initComponent(node, ComponentClass);\n      extendElement(node.element, instance);\n      instances.push(instance);\n    }\n  }\n  for (const instance of instances) {\n    if (typeof instance.connect === \"function\") instance.connect();\n  }\n};\n","import { buildElementTree } from \"./start/scan\";\nimport { validate } from \"./start/validate\";\nimport { initMatches } from \"./start/init\";\nimport { observe } from \"./start/observe\";\n\nconst start = (options = {}) => {\n  const searchRoot = options.root ?? document.body;\n  const componentClasses = Array.isArray(options.components)\n    ? options.components\n    : [];\n  const nodes = buildElementTree(searchRoot);\n  validate(nodes, componentClasses);\n  initMatches(nodes, componentClasses);\n  observe(searchRoot, componentClasses);\n  return nodes.filter((n) => n.parent === null);\n};\n\nexport default start;\n","import { dataComponentAttribute } from \"./config\";\n\nconst scanComponentElements = (searchRoot) => {\n  const componentElements = Array.from(\n    searchRoot.querySelectorAll(`[${dataComponentAttribute}]`),\n  );\n  if (\n    searchRoot instanceof Element &&\n    searchRoot.hasAttribute(dataComponentAttribute) &&\n    !componentElements.includes(searchRoot)\n  ) {\n    componentElements.unshift(searchRoot);\n  }\n  return componentElements;\n};\n\nexport const buildElementTree = (searchRoot) => {\n  const componentElements = scanComponentElements(searchRoot);\n  const nodes = componentElements.map((element) => ({\n    name: element.getAttribute(dataComponentAttribute),\n    element,\n    parent: null,\n    children: [],\n  }));\n\n  const elementToNode = new Map();\n  for (const node of nodes) elementToNode.set(node.element, node);\n\n  for (const element of componentElements) {\n    const node = elementToNode.get(element);\n    const parentElement = element.parentElement?.closest(\n      `[${dataComponentAttribute}]`,\n    );\n    if (parentElement && elementToNode.has(parentElement)) {\n      const parentNode = elementToNode.get(parentElement);\n      node.parent = parentNode;\n      parentNode.children.push(node);\n    }\n  }\n  return nodes;\n};\n","export const validate = (nodes, componentClasses) => {\n  if (nodes.length === 0) {\n    throw new Error(\"No component elements found in the root element\");\n  }\n  for (const C of componentClasses) {\n    const ctorName =\n      C.prototype?.constructor?.name || C.constructor?.name || \"(anonymous)\";\n    const desc = Object.getOwnPropertyDescriptor(C, \"name\");\n    if (\n      typeof C.name !== \"string\" ||\n      C.name.length === 0 ||\n      !desc ||\n      desc.writable !== true\n    ) {\n      throw new Error(\n        `Invalid component class: missing static name (${ctorName})`,\n      );\n    }\n  }\n  const domNames = new Set(nodes.map((n) => n.name));\n  const providedNames = new Set(componentClasses.map((C) => C.name));\n  for (const name of domNames) {\n    if (!providedNames.has(name)) {\n      throw new Error(\n        `Found data-component=\"${name}\" but no matching class passed to start({ components })`,\n      );\n    }\n  }\n};\n","import { dataComponentAttribute } from \"./config\";\nimport { initComponent, extendElement } from \"./init\";\n\nconst instancesForElements = (elements, classByName) => {\n  const instances = new Array();\n  for (const el of elements) {\n    const name = el.getAttribute(dataComponentAttribute);\n    const ComponentClass = classByName.get(name);\n    if (!ComponentClass) continue;\n\n    const node = { element: el, parent: null, children: [] };\n    const instance = initComponent(node, ComponentClass);\n    extendElement(el, instance);\n    instances.push(instance);\n  }\n  return instances;\n};\n\nconst filterElements = (added, classByName) => {\n  return Array.from(added).filter((el) => {\n    const name = el.getAttribute(dataComponentAttribute);\n    return classByName.has(name) && !el.instance;\n  });\n};\n\nconst addedElements = (mutations) => {\n  const added = new Set();\n  for (const m of mutations) {\n    for (const node of m.addedNodes) {\n      if (!(node instanceof Element)) continue;\n\n      if (node.hasAttribute(dataComponentAttribute)) added.add(node);\n      node\n        .querySelectorAll?.(`[${dataComponentAttribute}]`)\n        .forEach((el) => added.add(el));\n    }\n  }\n  return added;\n};\n\nexport const observe = (searchRoot, componentClasses) => {\n  const classByName = new Map();\n  for (const ComponentClass of componentClasses) {\n    classByName.set(ComponentClass.name, ComponentClass);\n  }\n\n  const observer = new MutationObserver((mutations) => {\n    const added = addedElements(mutations);\n    if (added.size === 0) return;\n\n    const filtered = filterElements(added, classByName);\n    if (filtered.length === 0) return;\n\n    const instances = instancesForElements(filtered, classByName);\n\n    for (const instance of instances) {\n      const parentEl = instance.element.parentElement?.closest(\n        `[${dataComponentAttribute}]`,\n      );\n      if (parentEl) {\n        const parentInstance = parentEl.instance;\n        if (parentInstance) {\n          instance.addParent(parentInstance);\n        }\n      }\n      for (const childInstance of instances) {\n        if (childInstance.element === instance.element) continue;\n\n        const nearest = childInstance.element.parentElement?.closest(\n          `[${dataComponentAttribute}]`,\n        );\n        if (nearest === instance.element) {\n          instance.node.children.push(childInstance.node);\n          childInstance.node.parent = instance.node;\n        }\n      }\n    }\n\n    for (const instance of instances) {\n      if (typeof instance.connect === \"function\") instance.connect();\n    }\n  });\n\n  observer.observe(searchRoot, { childList: true, subtree: true });\n};\n","export default class Component {\n  constructor() {\n    this._cleanupCallbacks = [];\n    this._isDisconnected = false;\n  }\n\n  addParent(parent) {\n    this.node.parent = parent.node;\n    parent.node.children.push(this.node);\n  }\n\n  registerCleanup(callback) {\n    if (typeof callback === \"function\") this._cleanupCallbacks.push(callback);\n    return callback;\n  }\n\n  on(target, type, listener, options) {\n    target.addEventListener(type, listener, options);\n    const off = () => target.removeEventListener(type, listener, options);\n    this.registerCleanup(off);\n    return off;\n  }\n\n  timeout(callback, delay) {\n    const id = setTimeout(callback, delay);\n    this.registerCleanup(() => clearTimeout(id));\n    return id;\n  }\n\n  interval(callback, delay) {\n    const id = setInterval(callback, delay);\n    this.registerCleanup(() => clearInterval(id));\n    return id;\n  }\n\n  disconnect() {\n    if (this._isDisconnected) return;\n    this._isDisconnected = true;\n    const callbacks = this._cleanupCallbacks.splice(0);\n    for (const cleanup of callbacks) cleanup();\n  }\n\n  ref(name) {\n    const list = Array.from(\n      this.element.querySelectorAll(`[data-ref=\"${name}\"]`),\n    );\n    if (list.length === 0) return [];\n    if (list.length === 1) return list[0];\n    return list;\n  }\n\n  refs() {\n    const temp = {};\n    const elements = this.element.querySelectorAll(\"[data-ref]\");\n    elements.forEach((el) => {\n      const key = el.getAttribute(\"data-ref\");\n      if (!temp[key]) temp[key] = [];\n      temp[key].push(el);\n    });\n    const result = {};\n    Object.keys(temp).forEach((key) => {\n      const arr = temp[key];\n      result[key] = arr.length === 1 ? arr[0] : arr;\n    });\n    return result;\n  }\n\n  parent() {\n    return this.node.parent?.element.instance;\n  }\n\n  children() {\n    return this.node.children.map((n) => n.element.instance);\n  }\n}\n"],"names":["root","factory","exports","module","define","amd","window","__webpack_require__","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","namespaceController","controller","callFunc","resource","name","constructor","getController","Controllers","subName","undefined","body","document","getElementsByTagName","namespaceName","getAttribute","controllerName","actionName","action","params","fetchParams","url","location","href","match","exec","id","parseInt","splitUrl","split","length","paramsArray","map","s","arr","decodeURIComponent","val","replace","dataComponentAttribute","componentIdCounter","initComponent","node","ComponentClass","instance","element","parent","children","componentId","extendElement","setAttribute","start","options","searchRoot","componentClasses","Array","isArray","components","nodes","componentElements","from","querySelectorAll","Element","hasAttribute","includes","unshift","scanComponentElements","elementToNode","Map","set","parentElement","closest","has","parentNode","push","buildElementTree","validate","Error","C","ctorName","desc","getOwnPropertyDescriptor","writable","domNames","Set","n","providedNames","initMatches","instances","connect","observe","classByName","MutationObserver","mutations","added","m","addedNodes","add","forEach","el","addedElements","size","filtered","filterElements","filter","instancesForElements","elements","parentEl","parentInstance","addParent","childInstance","nearest","childList","subtree","Component","this","_cleanupCallbacks","_isDisconnected","registerCleanup","callback","on","target","type","listener","addEventListener","off","removeEventListener","timeout","delay","setTimeout","clearTimeout","interval","setInterval","clearInterval","disconnect","callbacks","splice","cleanup","ref","list","refs","temp","result","keys"],"sourceRoot":""}