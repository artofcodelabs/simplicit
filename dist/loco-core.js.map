{"version":3,"file":"loco-core.js","mappings":"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","sources":["webpack://LocoCore/webpack/universalModuleDefinition","webpack://LocoCore/webpack/bootstrap","webpack://LocoCore/webpack/runtime/define property getters","webpack://LocoCore/webpack/runtime/hasOwnProperty shorthand","webpack://LocoCore/webpack/runtime/make namespace object","webpack://LocoCore/./src/init.js","webpack://LocoCore/./src/helpers.js","webpack://LocoCore/./src/start/config.js","webpack://LocoCore/./src/start/node.js","webpack://LocoCore/./src/start/id.js","webpack://LocoCore/./src/start/init.js","webpack://LocoCore/./src/start/helpers.js","webpack://LocoCore/./src/start.js","webpack://LocoCore/./src/start/scan.js","webpack://LocoCore/./src/start/validate.js","webpack://LocoCore/./src/start/observe.js","webpack://LocoCore/./src/component.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"LocoCore\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"LocoCore\"] = factory();\n\telse\n\t\troot[\"LocoCore\"] = factory();\n})(window, function() {\nreturn ","// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","let namespaceController = null;\nlet controller = null;\n\nconst callFunc = (resource, name) => {\n  if (typeof resource.constructor[name] === \"function\") {\n    resource.constructor[name]();\n  }\n  if (typeof resource[name] === \"function\") {\n    resource[name]();\n  }\n};\n\nconst getController = (Controllers, name, subName) => {\n  const resource =\n    subName === undefined ? Controllers[name] : Controllers[name][subName];\n  if (typeof resource === \"function\") {\n    return new resource();\n  } else if (typeof resource === \"object\") {\n    return resource;\n  }\n  return null;\n};\n\nconst init = (Controllers) => {\n  const body = document.getElementsByTagName(\"body\")[0];\n  const namespaceName = body.getAttribute(\"data-namespace\");\n  const controllerName = body.getAttribute(\"data-controller\");\n  const actionName = body.getAttribute(\"data-action\");\n\n  if (controller !== null) {\n    callFunc(controller, \"deinitialize\");\n    controller = null;\n  }\n  if (namespaceController !== null) {\n    callFunc(namespaceController, \"deinitialize\");\n    namespaceController = null;\n  }\n\n  namespaceController = getController(Controllers, namespaceName);\n  controller = getController(Controllers, controllerName);\n\n  if (namespaceController !== null) {\n    controller = getController(Controllers, namespaceName, controllerName);\n    namespaceController.controller = controller;\n    callFunc(namespaceController, \"initialize\");\n  }\n  if (controller !== null) {\n    controller.namespaceController = namespaceController;\n    callFunc(controller, \"initialize\");\n    callFunc(controller, actionName);\n  }\n\n  return { namespaceController, controller, action: actionName };\n};\n\nexport default init;\n","const fetchParams = (url = window.location.href) => {\n  const params = {};\n  const match = /https?:\\/\\/.+\\/\\w+\\/(\\d+)/.exec(url);\n  const id = match !== null ? match[1] : null;\n  if (id !== null) {\n    params[\"id\"] = parseInt(id);\n  }\n  const splitUrl = url.split(\"?\");\n  if (splitUrl.length === 1) return params;\n  const paramsString = splitUrl[splitUrl.length - 1];\n  const paramsArray = paramsString.split(\"&\").map((s) => s.split(\"=\"));\n  for (const arr of paramsArray) {\n    let key = decodeURIComponent(arr[0]);\n    let val = decodeURIComponent(arr[1]);\n    if (typeof val === \"string\") {\n      val = val.replace(/\\+/g, \" \");\n    }\n    params[key] = val;\n  }\n  return params;\n};\n\nexport default {\n  get params() {\n    return fetchParams();\n  },\n};\n","export const dataComponentAttribute = \"data-component\";\n","import { dataComponentAttribute } from \"./config\";\nexport const createNode = (element) => {\n  return {\n    name: element.getAttribute(dataComponentAttribute),\n    element,\n    parent: null,\n    children: [],\n    siblings: [],\n  };\n};\n","let componentIdCounter = 1;\nexport const generateComponentId = () => `${componentIdCounter++}`;\n","import { generateComponentId } from \"./id\";\n\nexport const initComponent = (node, ComponentClass) => {\n  const instance = new ComponentClass();\n  const { name, element, parent, children, siblings } = node;\n  instance.element = element;\n  instance.node = { name, element, parent, children, siblings };\n  instance.componentId = generateComponentId();\n  return instance;\n};\n\nexport const extendElement = (element, instance) => {\n  element.setAttribute(\"data-component-id\", instance.componentId);\n  element.instance = instance;\n};\n\nexport const initMatches = (nodes, componentClasses) => {\n  const instances = [];\n  for (const ComponentClass of componentClasses) {\n    for (const node of nodes) {\n      if (node.name != ComponentClass.name) continue;\n\n      const instance = initComponent(node, ComponentClass);\n      extendElement(node.element, instance);\n      instances.push(instance);\n    }\n  }\n  for (const instance of instances) {\n    if (typeof instance.connect === \"function\") instance.connect();\n  }\n  return instances;\n};\n","export const destructArray = (array) => {\n  return array.length === 1 ? array[0] : array;\n};\n","import { buildElementTree } from \"./start/scan\";\nimport { validate } from \"./start/validate\";\nimport { initMatches } from \"./start/init\";\nimport { observe } from \"./start/observe\";\nimport { destructArray } from \"./start/helpers\";\n\nconst start = (options = {}) => {\n  const searchRoot = options.root ?? document.body;\n  const componentClasses = Array.isArray(options.components)\n    ? options.components\n    : [];\n  const nodes = buildElementTree(searchRoot);\n  validate(nodes, componentClasses);\n  const instances = initMatches(nodes, componentClasses);\n  observe(searchRoot, componentClasses);\n  const roots = instances.filter((i) => i.node.parent === null);\n  return destructArray(roots);\n};\n\nexport default start;\n","import { dataComponentAttribute } from \"./config\";\nimport { createNode } from \"./node\";\n\nconst scanComponentElements = (searchRoot) => {\n  const componentElements = Array.from(\n    searchRoot.querySelectorAll(`[${dataComponentAttribute}]`),\n  );\n  if (\n    searchRoot instanceof Element &&\n    searchRoot.hasAttribute(dataComponentAttribute) &&\n    !componentElements.includes(searchRoot)\n  ) {\n    componentElements.unshift(searchRoot);\n  }\n  return componentElements;\n};\n\nexport const buildElementTree = (searchRoot) => {\n  const componentElements = scanComponentElements(searchRoot);\n  const nodes = componentElements.map((element) => createNode(element));\n\n  const elementToNode = new Map();\n  for (const node of nodes) elementToNode.set(node.element, node);\n\n  for (const element of componentElements) {\n    const node = elementToNode.get(element);\n    const parentElement = element.parentElement?.closest(\n      `[${dataComponentAttribute}]`,\n    );\n    if (parentElement && elementToNode.has(parentElement)) {\n      const parentNode = elementToNode.get(parentElement);\n      node.parent = parentNode;\n      parentNode.children.push(node);\n    }\n  }\n\n  const rootNodes = nodes.filter((n) => n.parent === null);\n  for (const node of rootNodes) {\n    node.siblings = rootNodes.filter((n) => n !== node);\n  }\n\n  return nodes;\n};\n","export const validate = (nodes, componentClasses) => {\n  if (nodes.length === 0) {\n    throw new Error(\"No component elements found in the root element\");\n  }\n  for (const C of componentClasses) {\n    const ctorName =\n      C.prototype?.constructor?.name || C.constructor?.name || \"(anonymous)\";\n    const desc = Object.getOwnPropertyDescriptor(C, \"name\");\n    if (\n      typeof C.name !== \"string\" ||\n      C.name.length === 0 ||\n      !desc ||\n      desc.writable !== true\n    ) {\n      throw new Error(\n        `Invalid component class: missing static name (${ctorName})`,\n      );\n    }\n  }\n  const domNames = new Set(nodes.map((n) => n.name));\n  const providedNames = new Set(componentClasses.map((C) => C.name));\n  for (const name of domNames) {\n    if (!providedNames.has(name)) {\n      throw new Error(\n        `Found data-component=\"${name}\" but no matching class passed to start({ components })`,\n      );\n    }\n  }\n};\n","import { dataComponentAttribute } from \"./config\";\nimport { initComponent, extendElement } from \"./init\";\nimport { createNode } from \"./node\";\n\nconst instancesForElements = (elements, classByName) => {\n  const instances = new Array();\n  for (const el of elements) {\n    const name = el.getAttribute(dataComponentAttribute);\n    const ComponentClass = classByName.get(name);\n    if (!ComponentClass) continue;\n\n    const node = createNode(el);\n    const instance = initComponent(node, ComponentClass);\n    extendElement(el, instance);\n    instances.push(instance);\n  }\n  return instances;\n};\n\nconst filterElements = (added, classByName) => {\n  return Array.from(added).filter((el) => {\n    const name = el.getAttribute(dataComponentAttribute);\n    return classByName.has(name) && !el.instance;\n  });\n};\n\nconst addedElements = (mutations) => {\n  const added = new Set();\n  for (const m of mutations) {\n    for (const node of m.addedNodes) {\n      if (!(node instanceof Element)) continue;\n\n      if (node.hasAttribute(dataComponentAttribute)) added.add(node);\n      node\n        .querySelectorAll?.(`[${dataComponentAttribute}]`)\n        .forEach((el) => added.add(el));\n    }\n  }\n  return added;\n};\n\nexport const observe = (searchRoot, componentClasses) => {\n  const classByName = new Map();\n  for (const ComponentClass of componentClasses) {\n    classByName.set(ComponentClass.name, ComponentClass);\n  }\n\n  const observer = new MutationObserver((mutations) => {\n    const added = addedElements(mutations);\n    if (added.size === 0) return;\n\n    const filtered = filterElements(added, classByName);\n    if (filtered.length === 0) return;\n\n    const instances = instancesForElements(filtered, classByName);\n\n    for (const instance of instances) {\n      const parentEl = instance.element.parentElement?.closest(\n        `[${dataComponentAttribute}]`,\n      );\n      if (parentEl) {\n        const parentInstance = parentEl.instance;\n        if (parentInstance) {\n          instance.addParent(parentInstance);\n        }\n      }\n      for (const childInstance of instances) {\n        if (childInstance.element === instance.element) continue;\n\n        const nearest = childInstance.element.parentElement?.closest(\n          `[${dataComponentAttribute}]`,\n        );\n        if (nearest === instance.element) {\n          instance.node.children.push(childInstance.node);\n          childInstance.node.parent = instance.node;\n        }\n      }\n    }\n\n    for (const instance of instances) {\n      if (typeof instance.connect === \"function\") instance.connect();\n    }\n  });\n\n  observer.observe(searchRoot, { childList: true, subtree: true });\n};\n","import { destructArray } from \"./start/helpers\";\n\nexport default class Component {\n  constructor() {\n    this._cleanupCallbacks = [];\n    this._isDisconnected = false;\n  }\n\n  addParent(parent) {\n    this.node.parent = parent.node;\n    parent.node.children.push(this.node);\n  }\n\n  registerCleanup(callback) {\n    if (typeof callback === \"function\") this._cleanupCallbacks.push(callback);\n    return callback;\n  }\n\n  on(target, type, listener, options) {\n    target.addEventListener(type, listener, options);\n    const off = () => target.removeEventListener(type, listener, options);\n    this.registerCleanup(off);\n    return off;\n  }\n\n  timeout(callback, delay) {\n    const id = setTimeout(callback, delay);\n    this.registerCleanup(() => clearTimeout(id));\n    return id;\n  }\n\n  interval(callback, delay) {\n    const id = setInterval(callback, delay);\n    this.registerCleanup(() => clearInterval(id));\n    return id;\n  }\n\n  disconnect() {\n    if (this._isDisconnected) return;\n    this._isDisconnected = true;\n    const callbacks = this._cleanupCallbacks.splice(0);\n    for (const cleanup of callbacks) cleanup();\n  }\n\n  ref(name) {\n    const list = Array.from(\n      this.element.querySelectorAll(`[data-ref=\"${name}\"]`),\n    );\n    return destructArray(list);\n  }\n\n  refs() {\n    const temp = {};\n    const elements = this.element.querySelectorAll(\"[data-ref]\");\n    elements.forEach((el) => {\n      const key = el.getAttribute(\"data-ref\");\n      if (!temp[key]) temp[key] = [];\n      temp[key].push(el);\n    });\n    const result = {};\n    Object.keys(temp).forEach((key) => {\n      result[key] = destructArray(temp[key]);\n    });\n    return result;\n  }\n\n  parent() {\n    return this.node.parent?.element.instance;\n  }\n\n  children(name) {\n    let nodes = this.node.children;\n    if (name) {\n      nodes = nodes.filter((n) => n.name === name);\n    }\n    return nodes.map((n) => n.element.instance);\n  }\n\n  siblings(name) {\n    return this.node.siblings\n      .filter((n) => n.name === name)\n      .map((n) => n.element.instance);\n  }\n}\n"],"names":["root","factory","exports","module","define","amd","window","__webpack_require__","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","namespaceController","controller","callFunc","resource","name","constructor","getController","Controllers","subName","undefined","body","document","getElementsByTagName","namespaceName","getAttribute","controllerName","actionName","action","params","fetchParams","url","location","href","match","exec","id","parseInt","splitUrl","split","length","paramsArray","map","s","arr","decodeURIComponent","val","replace","dataComponentAttribute","createNode","element","parent","children","siblings","componentIdCounter","initComponent","node","ComponentClass","instance","componentId","extendElement","setAttribute","destructArray","array","start","options","searchRoot","componentClasses","Array","isArray","components","nodes","componentElements","from","querySelectorAll","Element","hasAttribute","includes","unshift","scanComponentElements","elementToNode","Map","set","parentElement","closest","has","parentNode","push","rootNodes","filter","n","buildElementTree","validate","Error","C","ctorName","desc","getOwnPropertyDescriptor","writable","domNames","Set","providedNames","instances","initMatches","connect","observe","classByName","observer","MutationObserver","mutations","added","m","addedNodes","add","forEach","el","addedElements","size","filtered","filterElements","instancesForElements","elements","parentEl","parentInstance","addParent","childInstance","nearest","childList","subtree","roots","i","Component","this","_cleanupCallbacks","_isDisconnected","registerCleanup","callback","on","target","type","listener","addEventListener","off","removeEventListener","timeout","delay","setTimeout","clearTimeout","interval","setInterval","clearInterval","disconnect","callbacks","splice","cleanup","ref","list","refs","temp","result","keys"],"sourceRoot":""}