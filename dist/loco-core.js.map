{"version":3,"file":"loco-core.js","mappings":"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","sources":["webpack://LocoCore/webpack/universalModuleDefinition","webpack://LocoCore/webpack/bootstrap","webpack://LocoCore/webpack/runtime/define property getters","webpack://LocoCore/webpack/runtime/hasOwnProperty shorthand","webpack://LocoCore/webpack/runtime/make namespace object","webpack://LocoCore/./src/init.js","webpack://LocoCore/./src/helpers.js","webpack://LocoCore/./src/start/scan.js","webpack://LocoCore/./src/start/id.js","webpack://LocoCore/./src/start/observer.js","webpack://LocoCore/./src/start.js","webpack://LocoCore/./src/start/validate.js","webpack://LocoCore/./src/start/init.js","webpack://LocoCore/./src/component.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"LocoCore\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"LocoCore\"] = factory();\n\telse\n\t\troot[\"LocoCore\"] = factory();\n})(window, function() {\nreturn ","// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","let namespaceController = null;\nlet controller = null;\n\nconst callFunc = (resource, name) => {\n  if (typeof resource.constructor[name] === \"function\") {\n    resource.constructor[name]();\n  }\n  if (typeof resource[name] === \"function\") {\n    resource[name]();\n  }\n};\n\nconst getController = (Controllers, name, subName) => {\n  const resource =\n    subName === undefined ? Controllers[name] : Controllers[name][subName];\n  if (typeof resource === \"function\") {\n    return new resource();\n  } else if (typeof resource === \"object\") {\n    return resource;\n  }\n  return null;\n};\n\nconst init = (Controllers) => {\n  const body = document.getElementsByTagName(\"body\")[0];\n  const namespaceName = body.getAttribute(\"data-namespace\");\n  const controllerName = body.getAttribute(\"data-controller\");\n  const actionName = body.getAttribute(\"data-action\");\n\n  if (controller !== null) {\n    callFunc(controller, \"deinitialize\");\n    controller = null;\n  }\n  if (namespaceController !== null) {\n    callFunc(namespaceController, \"deinitialize\");\n    namespaceController = null;\n  }\n\n  namespaceController = getController(Controllers, namespaceName);\n  controller = getController(Controllers, controllerName);\n\n  if (namespaceController !== null) {\n    controller = getController(Controllers, namespaceName, controllerName);\n    namespaceController.controller = controller;\n    callFunc(namespaceController, \"initialize\");\n  }\n  if (controller !== null) {\n    controller.namespaceController = namespaceController;\n    callFunc(controller, \"initialize\");\n    callFunc(controller, actionName);\n  }\n\n  return { namespaceController, controller, action: actionName };\n};\n\nexport default init;\n","const fetchParams = (url = window.location.href) => {\n  const params = {};\n  const match = /https?:\\/\\/.+\\/\\w+\\/(\\d+)/.exec(url);\n  const id = match !== null ? match[1] : null;\n  if (id !== null) {\n    params[\"id\"] = parseInt(id);\n  }\n  const splitUrl = url.split(\"?\");\n  if (splitUrl.length === 1) return params;\n  const paramsString = splitUrl[splitUrl.length - 1];\n  const paramsArray = paramsString.split(\"&\").map((s) => s.split(\"=\"));\n  for (const arr of paramsArray) {\n    let key = decodeURIComponent(arr[0]);\n    let val = decodeURIComponent(arr[1]);\n    if (typeof val === \"string\") {\n      val = val.replace(/\\+/g, \" \");\n    }\n    params[key] = val;\n  }\n  return params;\n};\n\nexport default {\n  get params() {\n    return fetchParams();\n  },\n};\n","const dataComponentAttribute = \"data-component\";\n\nexport const scanComponentElements = (searchRoot) => {\n  const componentElements = Array.from(\n    searchRoot.querySelectorAll(`[${dataComponentAttribute}]`),\n  );\n  if (\n    searchRoot instanceof Element &&\n    searchRoot.hasAttribute(dataComponentAttribute) &&\n    !componentElements.includes(searchRoot)\n  ) {\n    componentElements.unshift(searchRoot);\n  }\n  return componentElements;\n};\n\nexport const buildElementTree = (componentElements) => {\n  const elementToNode = new Map();\n  for (const element of componentElements) {\n    const name = element.getAttribute(dataComponentAttribute);\n    elementToNode.set(element, {\n      name,\n      element,\n      parent: null,\n      children: [],\n    });\n  }\n  for (const element of componentElements) {\n    const node = elementToNode.get(element);\n    const parentElement = element.parentElement?.closest(`[${dataComponentAttribute}]`);\n    if (parentElement && elementToNode.has(parentElement)) {\n      const parentNode = elementToNode.get(parentElement);\n      node.parent = parentNode;\n      parentNode.children.push(node);\n    }\n  }\n  return elementToNode;\n};\n","let componentIdCounter = 1;\nexport const generateComponentId = () => `${componentIdCounter++}`;\n","import { generateComponentId } from \"./id\";\n\nconst rootToObserver = new WeakMap(); // Element -> { observer, classByName }\n\nexport const ensureObservation = (searchRoot, componentClasses) => {\n  const classByName = new Map();\n\n  for (const ComponentClass of componentClasses) {\n    classByName.set(ComponentClass.name, ComponentClass);\n  }\n\n  const observer = new MutationObserver((mutations) => {\n    const added = new Set();\n    for (const m of mutations) {\n      for (const node of m.addedNodes) {\n        if (!(node instanceof Element)) continue;\n        if (node.hasAttribute(\"data-component\")) added.add(node);\n        node\n          .querySelectorAll?.(\"[data-component]\")\n          .forEach((el) => added.add(el));\n      }\n    }\n\n    if (added.size === 0) return;\n\n    const candidates = Array.from(added).filter((el) => {\n      const name = el.getAttribute(\"data-component\");\n      return classByName.has(name) && !el.instance;\n    });\n    if (candidates.length === 0) return;\n\n    const elementToInstance = new Map();\n    for (const el of candidates) {\n      const name = el.getAttribute(\"data-component\");\n      const ComponentClass = classByName.get(name);\n      if (!ComponentClass) continue;\n      const instance = new ComponentClass();\n      instance.element = el;\n      instance.node = { parent: null, children: [] };\n      instance.componentId = generateComponentId();\n      el.setAttribute(\"data-component-id\", instance.componentId);\n      el.instance = instance;\n      elementToInstance.set(el, instance);\n    }\n\n    for (const el of candidates) {\n      const instance = elementToInstance.get(el);\n      if (!instance) continue;\n      const parentEl = el.parentElement?.closest(\"[data-component]\");\n      if (parentEl) {\n        const parentInstance =\n          elementToInstance.get(parentEl) || parentEl.instance;\n        if (parentInstance && parentInstance.node) {\n          instance.node.parent = parentInstance.node;\n          parentInstance.node.children.push(instance.node);\n        }\n      }\n      for (const child of candidates) {\n        if (child === el) continue;\n        const nearest = child.parentElement?.closest(\"[data-component]\");\n        if (nearest === el) {\n          const childInstance = elementToInstance.get(child);\n          if (childInstance) {\n            instance.node.children.push(childInstance.node);\n            childInstance.node.parent = instance.node;\n          }\n        }\n      }\n    }\n\n    for (const instance of elementToInstance.values()) {\n      if (typeof instance.connect === \"function\") instance.connect();\n    }\n  });\n\n  observer.observe(searchRoot, { childList: true, subtree: true });\n  rootToObserver.set(searchRoot, { observer, classByName });\n};\n","import { scanComponentElements, buildElementTree } from \"./start/scan\";\nimport { validate } from \"./start/validate\";\nimport { initializeMatches } from \"./start/init\";\nimport { ensureObservation } from \"./start/observer\";\n\nconst start = (options = {}) => {\n  const searchRoot = options.root ?? document.body;\n  const componentClasses = Array.isArray(options.components)\n    ? options.components\n    : [];\n  const componentElements = scanComponentElements(searchRoot);\n  validate(componentElements, componentClasses);\n  const elementToNode = buildElementTree(componentElements);\n  initializeMatches(elementToNode, componentClasses);\n  ensureObservation(searchRoot, componentClasses);\n  const components = [];\n  components.push(\n    ...Array.from(elementToNode.values()).filter((n) => n.parent === null),\n  );\n  return components;\n};\n\nexport default start;\n","export const validate = (componentElements, componentClasses) => {\n  if (componentElements.length === 0) {\n    throw new Error(\"No component elements found in the root element\");\n  }\n  for (const C of componentClasses) {\n    const ctorName =\n      (C && C.prototype && C.prototype.constructor\n        ? C.prototype.constructor.name\n        : null) ||\n      (C && C.constructor ? C.constructor.name : null) ||\n      \"(anonymous)\";\n    const desc = Object.getOwnPropertyDescriptor(C, \"name\");\n    if (\n      typeof C?.name !== \"string\" ||\n      C.name.length === 0 ||\n      !desc || desc.writable !== true\n    ) {\n      throw new Error(\n        `Invalid component class: missing static name (${ctorName})`,\n      );\n    }\n  }\n  const domNames = new Set(\n    Array.from(componentElements, (el) => el.getAttribute(\"data-component\")),\n  );\n  const providedNames = new Set(\n    (Array.isArray(componentClasses) ? componentClasses : [])\n      .map((C) => (typeof C?.name === \"string\" ? C.name : null))\n      .filter(Boolean),\n  );\n  for (const name of domNames) {\n    if (!providedNames.has(name)) {\n      throw new Error(\n        `Found data-component=\"${name}\" but no matching class passed to start({ components })`,\n      );\n    }\n  }\n};\n","import { generateComponentId } from \"./id\";\n\nexport const initializeMatches = (elementToNode, componentClasses) => {\n  for (const ComponentClass of componentClasses) {\n    // TODO: validate componentClasses first\n    const componentName =\n      typeof ComponentClass?.name === \"string\" ? ComponentClass.name : null;\n    if (!componentName) continue;\n\n    const matches = [];\n    for (const node of elementToNode.values()) {\n      if (node.name === componentName) matches.push(node);\n    }\n\n    for (const node of matches) {\n      const instance = new ComponentClass();\n      instance.element = node.element;\n      const sanitizedNode = { ...node };\n      delete sanitizedNode.name;\n      delete sanitizedNode.element;\n      instance.node = sanitizedNode;\n      instance.componentId = generateComponentId();\n      node.element.setAttribute(\"data-component-id\", instance.componentId);\n      node.element.instance = instance;\n      if (typeof instance.connect === \"function\") instance.connect();\n    }\n  }\n};\n","export default class Component {\n  constructor() {\n    this._cleanupCallbacks = [];\n    this._isDisconnected = false;\n  }\n\n  registerCleanup(callback) {\n    if (typeof callback === \"function\") this._cleanupCallbacks.push(callback);\n    return callback;\n  }\n\n  on(target, type, listener, options) {\n    target.addEventListener(type, listener, options);\n    const off = () => target.removeEventListener(type, listener, options);\n    this.registerCleanup(off);\n    return off;\n  }\n\n  timeout(callback, delay) {\n    const id = setTimeout(callback, delay);\n    this.registerCleanup(() => clearTimeout(id));\n    return id;\n  }\n\n  interval(callback, delay) {\n    const id = setInterval(callback, delay);\n    this.registerCleanup(() => clearInterval(id));\n    return id;\n  }\n\n  disconnect() {\n    if (this._isDisconnected) return;\n    this._isDisconnected = true;\n    const callbacks = this._cleanupCallbacks.splice(0);\n    for (const cleanup of callbacks) cleanup();\n  }\n\n  ref(name) {\n    const list = Array.from(\n      this.element.querySelectorAll(`[data-ref=\"${name}\"]`),\n    );\n    if (list.length === 0) return [];\n    if (list.length === 1) return list[0];\n    return list;\n  }\n\n  refs() {\n    const temp = {};\n    const elements = this.element.querySelectorAll(\"[data-ref]\");\n    elements.forEach((el) => {\n      const key = el.getAttribute(\"data-ref\");\n      if (!temp[key]) temp[key] = [];\n      temp[key].push(el);\n    });\n    const result = {};\n    Object.keys(temp).forEach((key) => {\n      const arr = temp[key];\n      result[key] = arr.length === 1 ? arr[0] : arr;\n    });\n    return result;\n  }\n}\n"],"names":["root","factory","exports","module","define","amd","window","__webpack_require__","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","namespaceController","controller","callFunc","resource","name","constructor","getController","Controllers","subName","undefined","body","document","getElementsByTagName","namespaceName","getAttribute","controllerName","actionName","action","params","fetchParams","url","location","href","match","exec","id","parseInt","splitUrl","split","length","paramsArray","map","s","arr","decodeURIComponent","val","replace","dataComponentAttribute","componentIdCounter","generateComponentId","rootToObserver","WeakMap","start","options","searchRoot","componentClasses","Array","isArray","components","componentElements","from","querySelectorAll","Element","hasAttribute","includes","unshift","scanComponentElements","validate","Error","C","ctorName","desc","getOwnPropertyDescriptor","writable","domNames","Set","el","providedNames","filter","Boolean","has","elementToNode","Map","element","set","parent","children","node","parentElement","closest","parentNode","push","buildElementTree","initializeMatches","ComponentClass","componentName","matches","values","instance","sanitizedNode","componentId","setAttribute","connect","ensureObservation","classByName","observer","MutationObserver","mutations","added","m","addedNodes","add","forEach","size","candidates","elementToInstance","parentEl","parentInstance","child","nearest","childInstance","observe","childList","subtree","n","Component","this","_cleanupCallbacks","_isDisconnected","registerCleanup","callback","on","target","type","listener","addEventListener","off","removeEventListener","timeout","delay","setTimeout","clearTimeout","interval","setInterval","clearInterval","disconnect","callbacks","splice","cleanup","ref","list","refs","temp","result","keys"],"sourceRoot":""}