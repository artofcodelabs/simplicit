!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("LocoCore",[],e):"object"==typeof exports?exports.LocoCore=e():t.LocoCore=e()}(window,function(){return function(){"use strict";var t={d:function(e,n){for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})},o:function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r:function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{Component:function(){return f},helpers:function(){return l},init:function(){return s},start:function(){return p}});let n=null,o=null;const r=(t,e)=>{"function"==typeof t.constructor[e]&&t.constructor[e](),"function"==typeof t[e]&&t[e]()},c=(t,e,n)=>{const o=void 0===n?t[e]:t[e][n];return"function"==typeof o?new o:"object"==typeof o?o:null};var s=t=>{const e=document.getElementsByTagName("body")[0],s=e.getAttribute("data-namespace"),l=e.getAttribute("data-controller"),a=e.getAttribute("data-action");return null!==o&&(r(o,"deinitialize"),o=null),null!==n&&(r(n,"deinitialize"),n=null),n=c(t,s),o=c(t,l),null!==n&&(o=c(t,s,l),n.controller=o,r(n,"initialize")),null!==o&&(o.namespaceController=n,r(o,"initialize"),r(o,a)),{namespaceController:n,controller:o,action:a}},l={get params(){return((t=window.location.href)=>{const e={},n=/https?:\/\/.+\/\w+\/(\d+)/.exec(t),o=null!==n?n[1]:null;null!==o&&(e.id=parseInt(o));const r=t.split("?");if(1===r.length)return e;const c=r[r.length-1].split("&").map(t=>t.split("="));for(const t of c){let n=decodeURIComponent(t[0]),o=decodeURIComponent(t[1]);"string"==typeof o&&(o=o.replace(/\+/g," ")),e[n]=o}return e})()}};const a=t=>{const e=t&&t.prototype&&t.prototype.constructor?t.prototype.constructor.name:"(anonymous)";console.warn(`Component class ${e} passed to start({ components }) should implement static "name"`)};let i=1;const u=()=>""+i++;var p=(t={})=>{const e=t.root??document,n=Array.isArray(t.components)?t.components:[],o=[],r=e&&e.body?e.body:e,c=Array.from(r.querySelectorAll("[data-component]"));r instanceof Element&&r.hasAttribute("data-component")&&!c.includes(r)&&c.unshift(r);const s=new Map;for(const t of c){const e=t.getAttribute("data-component");s.set(t,{name:e,element:t,parent:null,children:[]})}for(const t of c){const e=s.get(t),n=t.parentElement?.closest("[data-component]");if(n&&s.has(n)){const t=s.get(n);e.parent=t,t.children.push(e)}else o.push(e)}for(const t of n){const e="string"==typeof t?.name?t.name:null;if(!e){a(t);continue}const n=[];for(const t of s.values())t.name===e&&n.push(t);for(const e of n){const n=new t;n.element=e.element;const o={...e};delete o.name,delete o.element,n.node=o,n.componentId=u(),e.element.setAttribute("data-component-id",n.componentId),e.element.instance=n,"function"==typeof n.connect&&n.connect()}}return((t,e)=>{if(!t||0===t.length)return;const n=new Set(Array.from(t,t=>t.getAttribute("data-component"))),o=new Set((Array.isArray(e)?e:[]).map(t=>"string"==typeof t?.name?t.name:null).filter(Boolean));for(const t of n)o.has(t)||console.warn(`Found data-component="${t}" but no matching class passed to start({ components })`)})(c,n),o};class f{constructor(){this._cleanupCallbacks=[],this._isDisconnected=!1}registerCleanup(t){return"function"==typeof t&&this._cleanupCallbacks.push(t),t}on(t,e,n,o){t.addEventListener(e,n,o);const r=()=>t.removeEventListener(e,n,o);return this.registerCleanup(r),r}timeout(t,e){const n=setTimeout(t,e);return this.registerCleanup(()=>clearTimeout(n)),n}interval(t,e){const n=setInterval(t,e);return this.registerCleanup(()=>clearInterval(n)),n}disconnect(){if(this._isDisconnected)return;this._isDisconnected=!0;const t=this._cleanupCallbacks.splice(0);for(const e of t)e()}ref(t){const e=Array.from(this.element.querySelectorAll(`[data-ref="${t}"]`));return 0===e.length?[]:1===e.length?e[0]:e}refs(){const t={};this.element.querySelectorAll("[data-ref]").forEach(e=>{const n=e.getAttribute("data-ref");t[n]||(t[n]=[]),t[n].push(e)});const e={};return Object.keys(t).forEach(n=>{const o=t[n];e[n]=1===o.length?o[0]:o}),e}}return e}()});
//# sourceMappingURL=loco-core.js.map